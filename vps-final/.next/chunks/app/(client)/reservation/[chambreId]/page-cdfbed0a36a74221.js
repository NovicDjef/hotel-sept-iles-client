(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1274,2126],{1274:(e,s,t)=>{"use strict";t.d(s,{Ap:()=>m,UG:()=>p,Xe:()=>d,bx:()=>u,checkChambreAvailability:()=>n,getAllForfaits:()=>j,getAllRoomTypes:()=>l,getAllServices:()=>h,getCertificatsAmounts:()=>b,getCurrentUser:()=>N,getSpaCategories:()=>v,k2:()=>i,lz:()=>o,rE:()=>x,registerGuest:()=>f,wN:()=>c});var a=t(49103);let r="cmiajn0ck0000r37cliherz4z",l=e=>{let s=e||r;return a.Ay.get("/api/v1/room-types/hotels/".concat(s))},n=e=>a.Ay.post("/chambres/availability",e),i=e=>{let s={hotelId:e.hotelId||r,checkInDate:e.checkInDate,checkOutDate:e.checkOutDate};return a.Ay.get("/api/v1/reservations/availability",{params:s})},c=e=>{let s={...e,hotelId:e.hotelId||r};return a.Ay.post("/api/v1/reservations/calculate",s)},o=e=>{let s={...e,hotelId:e.hotelId||r};return a.Ay.post("/api/v1/reservations/guest",s)},d=(e,s)=>a.Ay.post("/api/v1/reservations/".concat(e,"/confirm-payment"),s),m=e=>a.Ay.get("/api/v1/reviews/hotel/".concat(e)),x=e=>a.Ay.get("/api/v1/reviews/hotel/".concat(e,"/stats")),u=e=>a.Ay.post("/api/v1/reviews",e),p=e=>a.Ay.post("/api/v1/reviews/".concat(e,"/helpful")),h=()=>a.Ay.get("/api/v1/spa/services?hotelId=".concat(r)),j=()=>a.Ay.get("/api/v1/spa/forfaits?hotelId=".concat(r)),b=()=>a.Ay.get("/api/v1/spa/certificats/amounts?hotelId=".concat(r)),v=()=>a.Ay.get("/api/v1/reservations/spa-categories"),f=e=>a.Ay.post("/api/v1/auth/guest/register",e),N=()=>a.Ay.get("/auth/me")},6439:(e,s,t)=>{"use strict";t.d(s,{G:()=>l,j:()=>r});var a=t(1213);let r=()=>(0,a.wA)(),l=a.d4},25772:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>J});var a=t(95155),r=t(12115),l=t(34486),n=t(20063),i=t(15239),c=t(12890),o=t(16485),d=t(95740),m=t(91169),x=t(78519),u=t(35626),p=t(5917),h=t(26983),j=t(23327),b=t(25563),v=t(52987),f=t(45345),N=t(6191),g=t(6439),y=t(12967);function w(e){let{selectedServices:s,onServicesChange:n,checkIn:c,checkOut:o}=e,m=(0,g.j)(),{services:x,categories:u,loading:j,error:b}=(0,g.G)(e=>e.services),[v,w]=(0,r.useState)("tous");(0,r.useEffect)(()=>{(async()=>{let{ensureGuestAuth:e}=await t.e(7052).then(t.bind(t,74671));await e(),0===x.length&&m((0,y.q_)())})()},[m,x.length]);let k="tous"===v?x:x.filter(e=>e.categorie.toLowerCase()===v);return(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"font-display text-2xl font-bold text-neutral-900 mb-2",children:"Ajoutez des services spa"}),(0,a.jsx)("p",{className:"text-neutral-600 mb-4",children:"Profitez de nos services premium pendant votre s\xe9jour"}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl p-4 text-white",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-white/20 rounded-full p-2",children:(0,a.jsx)(f.A,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-bold text-sm mb-1",children:"\uD83C\uDF81 Offre exclusive r\xe9servation"}),(0,a.jsxs)("p",{className:"text-xs text-white/90",children:[(0,a.jsx)("strong",{children:"-10% automatique"})," sur tous les services spa ajout\xe9s \xe0 votre r\xe9servation de chambre !"]})]})]})})]}),j&&0===x.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary-600 border-r-transparent mb-4"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"Chargement des services spa..."})]}),b&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[(0,a.jsx)("p",{className:"text-red-600 mb-4",children:b}),(0,a.jsx)("button",{onClick:()=>m((0,y.q_)()),className:"btn-secondary",children:"R\xe9essayer"})]}),!j&&!b&&x.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex gap-2 mb-6 overflow-x-auto scrollbar-hide pb-2",children:u.map(e=>(0,a.jsx)("button",{onClick:()=>w(e.slug),className:"px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ".concat(v===e.slug?"bg-primary-600 text-white":"bg-neutral-100 text-neutral-700 hover:bg-neutral-200"),children:e.name},e.id))}),(0,a.jsx)("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:k.map(e=>{var t,r,d;let m=s.some(s=>s.id===e.id),x=e.duree[0],u=e.prix[x];return(0,a.jsxs)(l.P.div,{layout:!0,className:"relative overflow-hidden rounded-2xl border-2 transition-all cursor-pointer ".concat(m?"border-primary-500 bg-primary-50":"border-neutral-200 bg-white hover:border-neutral-300"),onClick:()=>(e=>{if(s.find(s=>s.id===e.id))n(s.filter(s=>s.id!==e.id));else{let t=e.duree[0],a=e.prix[t];n([...s,{...e,dureeSelectionnee:t,prixSelectionne:a,date:c,heure:"10:00",nombrePersonnes:1}])}})(e),children:[(0,a.jsxs)("div",{className:"flex gap-4 p-4",children:[(0,a.jsx)("div",{className:"relative w-24 h-24 rounded-xl overflow-hidden flex-shrink-0",children:(0,a.jsx)(i.default,{src:e.image||"/images/spa/default.jpg",alt:e.nom,fill:!0,className:"object-cover"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-semibold text-neutral-900 mb-1",children:e.nom}),(0,a.jsx)("p",{className:"text-sm text-neutral-600 mb-2 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-neutral-500",children:[(0,a.jsx)(h.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[x," min"]})]}),(0,a.jsx)("span",{className:"text-neutral-400",children:"•"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-neutral-400 line-through text-xs",children:[u,"$"]}),(0,a.jsxs)("span",{className:"font-bold text-green-600",children:[Math.round(.9*u),"$"]}),(0,a.jsx)("span",{className:"bg-green-100 text-green-700 px-1.5 py-0.5 rounded text-[10px] font-bold",children:"-10%"})]})]})]}),(0,a.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border-2 transition-all ".concat(m?"bg-primary-600 border-primary-600":"border-neutral-300"),children:m&&(0,a.jsx)(l.P.div,{initial:{scale:0},animate:{scale:1},children:(0,a.jsx)(N.A,{className:"h-4 w-4 text-white rotate-45"})})})]}),m&&(0,a.jsx)(l.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-primary-200 bg-primary-50/50 p-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-neutral-700 mb-1",children:"Date"}),(0,a.jsx)("input",{type:"date",min:c,max:o,value:(null==(t=s.find(s=>s.id===e.id))?void 0:t.date)||c,className:"input-custom text-sm",onClick:e=>e.stopPropagation(),onChange:t=>{n(s.map(s=>s.id===e.id?{...s,date:t.target.value}:s))}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-neutral-700 mb-1",children:"Heure"}),(0,a.jsx)("select",{className:"input-custom text-sm",value:(null==(r=s.find(s=>s.id===e.id))?void 0:r.heure)||"10:00",onClick:e=>e.stopPropagation(),onChange:t=>{n(s.map(s=>s.id===e.id?{...s,heure:t.target.value}:s))},children:["09:00","10:00","11:00","14:00","15:00","16:00","17:00"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-neutral-700 mb-1",children:"Nombre de personnes"}),(0,a.jsx)("select",{className:"input-custom text-sm",value:(null==(d=s.find(s=>s.id===e.id))?void 0:d.nombrePersonnes)||1,onClick:e=>e.stopPropagation(),onChange:t=>{n(s.map(s=>s.id===e.id?{...s,nombrePersonnes:parseInt(t.target.value)}:s))},children:[1,2,3,4].map(e=>(0,a.jsxs)("option",{value:e,children:[e," personne",e>1?"s":""]},e))})]})]})})]},e.id)})}),s.length>0&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"bg-green-600 rounded-full p-2",children:(0,a.jsx)(d.A,{className:"h-4 w-4 text-white"})}),(0,a.jsxs)("span",{className:"font-bold text-green-900",children:[s.length," service",s.length>1?"s":""," s\xe9lectionn\xe9",s.length>1?"s":""]})]}),(0,a.jsx)("span",{className:"bg-green-600 text-white px-3 py-1 rounded-full text-xs font-bold",children:"-10% R\xc9DUCTION"})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between text-neutral-700",children:[(0,a.jsx)("span",{children:"Prix original :"}),(0,a.jsxs)("span",{className:"line-through",children:[s.reduce((e,s)=>e+(s.prixSelectionne||0),0).toFixed(2),"$"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-green-700 font-semibold",children:[(0,a.jsx)("span",{children:"R\xe9duction (-10%) :"}),(0,a.jsxs)("span",{children:["-",(.1*s.reduce((e,s)=>e+(s.prixSelectionne||0),0)).toFixed(2),"$"]})]}),(0,a.jsxs)("div",{className:"border-t border-green-300 pt-2 flex justify-between text-green-900 font-bold text-base",children:[(0,a.jsx)("span",{children:"Total avec r\xe9duction :"}),(0,a.jsxs)("span",{children:[(.9*s.reduce((e,s)=>e+(s.prixSelectionne||0),0)).toFixed(2),"$"]})]})]}),(0,a.jsxs)("p",{className:"text-xs text-green-700 mt-3 flex items-center gap-1",children:[(0,a.jsx)(p.A,{className:"h-3 w-3"}),"\xc9conomisez automatiquement 10% sur tous les services spa avec votre r\xe9servation !"]})]})]})]})}function k(e,s){let t=0,a=new Date(e);for(;a<s;)(function(e){let s=e.getDay();return 5===s||6===s||0===s})(a)&&t++,a.setDate(a.getDate()+1);return t}function S(e,s,t,a){let r=Math.ceil(Math.abs(s.getTime()-e.getTime())/864e5),l=k(e,s),n=r-l,i=n*t,c=l*a;return{totalNights:r,weekdayNights:n,weekendNights:l,weekdayTotal:i,weekendTotal:c,totalPrice:i+c,hasWeekend:l>0}}function A(e){return new Date(e+"T00:00:00")}function D(e){let{chambre:s,nights:t,selectedServices:c,total:o,subtotal:m,tps:x,tvq:u,chambrePrix:p}=e;(0,n.useRouter)();let h=(0,n.useSearchParams)(),[j]=(0,r.useState)(h.get("checkIn")||""),[b]=(0,r.useState)(h.get("checkOut")||""),v=j&&b?S(A(j),A(b),s.prix,s.prixWeekend):null,N=p||(null==v?void 0:v.totalPrice)||t*s.prix,g=(null==v?void 0:v.totalPrice)||t*s.prix,y=c.reduce((e,s)=>e+(s.prixSelectionne||s.prix||0)*(s.nombrePersonnes||1),0),w=.1*y,k=.9*y,D=.05*g,P=.09975*g,C=D+P+N;return(0,a.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card-premium p-6",children:[(0,a.jsx)("h3",{className:"font-display text-xl font-bold text-neutral-900 mb-6",children:"R\xe9capitulatif"}),(0,a.jsxs)("div",{className:"mb-6 pb-6 border-b border-neutral-200",children:[(0,a.jsxs)("div",{className:"flex gap-3 mb-3",children:[(0,a.jsx)("div",{className:"relative w-20 h-20 rounded-xl overflow-hidden flex-shrink-0",children:(0,a.jsx)(i.default,{src:s.image,alt:s.nom,fill:!0,className:"object-cover"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-semibold text-neutral-900",children:s.nom}),(0,a.jsxs)("div",{className:"text-sm text-neutral-600",children:[t," nuit",t>1?"s":""]})]})]}),(0,a.jsxs)("div",{className:"bg-neutral-50 rounded-lg p-3 space-y-1.5",children:[v&&v.hasWeekend?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-neutral-600",children:"Nuits semaine"}),(0,a.jsxs)("span",{className:"font-medium text-neutral-900",children:[v.weekdayNights," \xd7 ",s.prix,"$ = ",v.weekdayTotal,"$"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-neutral-600",children:"Nuits weekend"}),(0,a.jsxs)("span",{className:"font-medium text-amber-600",children:[v.weekendNights," \xd7 ",s.prixWeekend,"$ = ",v.weekendTotal,"$"]})]}),v.weekendNights>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-amber-600 bg-amber-50 rounded px-2 py-1",children:[(0,a.jsx)(d.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"Tarif weekend appliqu\xe9"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm pt-1",children:[(0,a.jsx)("span",{className:"text-neutral-700 font-medium",children:"Sous-total chambre"}),(0,a.jsxs)("span",{className:"font-semibold text-neutral-900",children:[g.toFixed(2),"$"]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-neutral-600",children:"Prix par nuit"}),(0,a.jsxs)("span",{className:"font-medium text-neutral-900",children:[s.prix,"$"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-neutral-600",children:"Nombre de nuits"}),(0,a.jsxs)("span",{className:"font-medium text-neutral-900",children:["\xd7 ",t]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm pt-1",children:[(0,a.jsx)("span",{className:"text-neutral-700 font-medium",children:"Sous-total chambre"}),(0,a.jsxs)("span",{className:"font-semibold text-neutral-900",children:[g.toFixed(2),"$"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-neutral-600",children:"T.P.S (5%)"}),(0,a.jsxs)("span",{className:"font-medium text-neutral-900",children:[D.toFixed(2),"$"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-neutral-600",children:"T.V.Q (9,975%)"}),(0,a.jsxs)("span",{className:"font-medium text-neutral-900",children:[P.toFixed(2),"$"]})]}),(0,a.jsx)("div",{className:"h-px bg-neutral-200 my-1"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-neutral-700",children:"Total chambre"}),(0,a.jsxs)("span",{className:"font-semibold text-primary-600",children:[C.toFixed(2),"$"]})]})]})]}),c.length>0&&(0,a.jsxs)("div",{className:"mb-6 pb-6 border-b border-neutral-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 text-primary-600"}),(0,a.jsx)("span",{className:"font-semibold text-neutral-900",children:"Services spa"}),(0,a.jsx)("span",{className:"bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs font-bold",children:"-10%"})]}),(0,a.jsx)("div",{className:"space-y-2",children:c.map((e,s)=>{let t=e.prixSelectionne||e.prix||0,r=e.nombrePersonnes||1,l=t*r,n=.9*l;return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-neutral-700",children:e.nom}),r>1&&(0,a.jsxs)("span",{className:"text-xs text-neutral-500 bg-neutral-100 px-2 py-0.5 rounded",children:["\xd7 ",r," pers."]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-neutral-400 line-through text-xs",children:[l.toFixed(2),"$"]}),(0,a.jsxs)("span",{className:"font-semibold text-green-600",children:[n.toFixed(2),"$"]})]})]}),r>1&&(0,a.jsxs)("div",{className:"text-xs text-neutral-500 pl-2",children:[t,"$ \xd7 ",r," personne",r>1?"s":""]})]},s)})})]}),k>0&&(0,a.jsx)("div",{className:"space-y-2 mb-6 pb-6 border-b border-neutral-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-neutral-600",children:"Total services"}),(0,a.jsxs)("span",{className:"font-semibold text-neutral-900",children:[(.05*k+.09975*k+k).toFixed(2),"$"]})]})}),(0,a.jsx)("div",{className:"pt-4 border-t-2 border-primary-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-semibold text-neutral-900",children:"Total"}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-display text-3xl font-bold text-primary-600",children:[o.toFixed(2),"$"]}),(0,a.jsx)("div",{className:"text-xs text-neutral-600",children:"CAD"})]})]})}),c.length>0&&(0,a.jsxs)("div",{className:"mt-4 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("div",{className:"bg-green-600 rounded-full p-1.5",children:(0,a.jsx)(f.A,{className:"h-3 w-3 text-white"})}),(0,a.jsx)("span",{className:"font-bold text-green-900 text-sm",children:"R\xe9duction r\xe9servation de chambre"})]}),(0,a.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between text-green-700",children:[(0,a.jsx)("span",{children:"Prix original services :"}),(0,a.jsxs)("span",{className:"line-through",children:[y.toFixed(2),"$"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-green-700 font-semibold",children:[(0,a.jsx)("span",{children:"R\xe9duction (-10%) :"}),(0,a.jsxs)("span",{children:["-",w.toFixed(2),"$"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-green-900 font-bold text-sm pt-1",children:[(0,a.jsx)("span",{children:"\xc9conomisez :"}),(0,a.jsxs)("span",{children:[w.toFixed(2),"$"]})]})]})]})]})}var P=t(27816),C=t(20508),I=t(23664),E=t(69141),O=t(21873),F=t(51581);function T(e){let{onClientInfoChange:s,initialData:t}=e,l=(0,g.j)(),{user:n,isAuthenticated:i,loading:c}=(0,g.G)(e=>e.auth),[o,d]=(0,r.useState)(t||{prenom:"",nom:"",email:"",telephone:"",adresse:"",ville:"",codePostal:"",commentaires:""}),[m,x]=(0,r.useState)({}),[u,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&s(t)},[]),(0,r.useEffect)(()=>{if(i&&n){let e={prenom:n.firstName||"",nom:n.lastName||"",email:n.email||"",telephone:n.phone||"",adresse:o.adresse||"",ville:o.ville||"",codePostal:o.codePostal||"",commentaires:o.commentaires||""};d(e),s(e)}},[i,n]);let h=e=>{let{name:t,value:a}=e.target,r={...o,[t]:a};d(r),s(r),m[t]&&x({...m,[t]:""})},j=async()=>{let e;if(!i&&o.prenom&&o.nom&&o.email&&o.telephone&&(e=o.email,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))&&!u){p(!0);try{await l((0,F.YT)({firstName:o.prenom,lastName:o.nom,email:o.email,phone:o.telephone,address:o.adresse||void 0})).unwrap()}catch(e){console.error("Erreur lors de l'enregistrement:",e)}finally{p(!1)}}};return(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"font-display text-2xl font-bold text-neutral-900",children:"Vos informations"}),i&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,a.jsx)(P.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Compte client actif"})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Pr\xe9nom *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(C.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,a.jsx)("input",{type:"text",name:"prenom",value:o.prenom,onChange:h,onBlur:j,className:"input-custom pl-10",placeholder:"Jean",required:!0,disabled:i})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Nom *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(C.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,a.jsx)("input",{type:"text",name:"nom",value:o.nom,onChange:h,onBlur:j,className:"input-custom pl-10",placeholder:"Tremblay",required:!0,disabled:i})]})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Email *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(I.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,a.jsx)("input",{type:"email",name:"email",value:o.email,onChange:h,onBlur:j,className:"input-custom pl-10",placeholder:"jean.tremblay@email.com",required:!0,disabled:i})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"T\xe9l\xe9phone *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(E.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,a.jsx)("input",{type:"tel",name:"telephone",value:o.telephone,onChange:h,onBlur:j,className:"input-custom pl-10",placeholder:"+1 418 962-2581",required:!0,disabled:i})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Adresse"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(O.A,{className:"absolute left-3 top-3 h-5 w-5 text-neutral-400"}),(0,a.jsx)("input",{type:"text",name:"adresse",value:o.adresse,onChange:h,className:"input-custom pl-10",placeholder:"123 rue Principale"})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Ville"}),(0,a.jsx)("input",{type:"text",name:"ville",value:o.ville,onChange:h,className:"input-custom",placeholder:"Qu\xe9bec"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Code postal"}),(0,a.jsx)("input",{type:"text",name:"codePostal",value:o.codePostal,onChange:h,className:"input-custom",placeholder:"G1A 1A1"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Demandes sp\xe9ciales (optionnel)"}),(0,a.jsx)("textarea",{name:"commentaires",value:o.commentaires,onChange:h,rows:4,className:"input-custom resize-none",placeholder:"Arriv\xe9e tardive, \xe9tage \xe9lev\xe9, etc."})]}),i?(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:(0,a.jsx)("p",{className:"text-sm text-green-700",children:"✅ Vos informations sont pr\xe9-remplies depuis votre compte client"})}):(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:(0,a.jsx)("p",{className:"text-sm text-blue-700",children:"\uD83D\uDCA1 Un compte client sera automatiquement cr\xe9\xe9 avec vos informations pour faciliter vos futures r\xe9servations"})}),u&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-primary-600",children:[(0,a.jsx)("div",{className:"inline-block h-4 w-4 animate-spin rounded-full border-2 border-solid border-primary-600 border-r-transparent"}),(0,a.jsx)("span",{className:"text-sm",children:"Cr\xe9ation de votre compte..."})]})]})]})}var $=t(76907),R=t(99708),q=t(91078),W=t(919);function _(e){let{amount:s,onSuccess:t,onError:l,loading:n=!1}=e,i=(0,c.t2)(),d=(0,c.HH)(),[m,u]=(0,r.useState)(!1),[p,h]=(0,r.useState)(null),[j,b]=(0,r.useState)(!1),v=async e=>{if(e.preventDefault(),!i||!d||!j)return void h("Veuillez accepter les conditions g\xe9n\xe9rales");u(!0),h(null);try{let e=d.getElement(c._D);if(!e)throw Error("\xc9l\xe9ment de carte non trouv\xe9");let{error:s,paymentMethod:a}=await i.createPaymentMethod({type:"card",card:e});if(s)throw Error(s.message||"Erreur de paiement");if(!a)throw Error("Impossible de cr\xe9er la m\xe9thode de paiement");t(a.id)}catch(s){let e=s.message||"Une erreur est survenue lors du paiement";h(e),l(e)}finally{u(!1)}},f={style:{base:{fontSize:"16px",color:"#1f2937",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',"::placeholder":{color:"#9ca3af"},lineHeight:"24px",padding:"12px 0"},invalid:{color:"#ef4444",iconColor:"#ef4444"},complete:{color:"#059669",iconColor:"#059669"}}};return(0,a.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[(0,a.jsx)($.A,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-semibold text-blue-900 mb-1",children:"Paiement 100% s\xe9curis\xe9"}),(0,a.jsx)("div",{className:"text-sm text-blue-700",children:"Vos informations sont crypt\xe9es et prot\xe9g\xe9es par Stripe"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between bg-neutral-50 rounded-lg p-3",children:[(0,a.jsx)("span",{className:"text-sm text-neutral-600 font-medium",children:"Cartes accept\xe9es :"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"bg-white rounded border border-neutral-200 px-2 py-1 text-xs font-semibold text-neutral-700",children:"VISA"}),(0,a.jsx)("div",{className:"bg-white rounded border border-neutral-200 px-2 py-1 text-xs font-semibold text-neutral-700",children:"Mastercard"}),(0,a.jsx)("div",{className:"bg-white rounded border border-neutral-200 px-2 py-1 text-xs font-semibold text-neutral-700",children:"AMEX"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Num\xe9ro de carte"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400 pointer-events-none z-10"}),(0,a.jsx)("div",{className:"input-custom pl-10",children:(0,a.jsx)(c._D,{options:f})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Date d'expiration"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400 pointer-events-none z-10"}),(0,a.jsx)("div",{className:"input-custom pl-10",children:(0,a.jsx)(c.qs,{options:f})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-neutral-700 mb-2 flex items-center gap-2",children:["CVV",(0,a.jsx)("span",{className:"text-xs text-neutral-500 font-normal",children:"(3 chiffres au dos)"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(R.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400 pointer-events-none z-10"}),(0,a.jsx)("div",{className:"input-custom pl-10",children:(0,a.jsx)(c.JG,{options:f})})]})]})]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-2",children:["\uD83D\uDCB3 Cartes de test : ",(0,a.jsx)("span",{className:"font-mono",children:"4242 4242 4242 4242"})," (Succ\xe8s) • ",(0,a.jsx)("span",{className:"font-mono",children:"4000 0000 0000 0002"})," (Refus\xe9e)"]})]}),p&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[(0,a.jsx)(q.A,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-red-900 mb-1",children:"Erreur de paiement"}),(0,a.jsx)("div",{className:"text-sm text-red-700",children:p})]})]}),(0,a.jsxs)("label",{className:"flex items-start gap-3 p-4 rounded-xl bg-neutral-50 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:j,onChange:e=>b(e.target.checked),className:"mt-1 rounded text-primary-600 focus:ring-primary-500"}),(0,a.jsxs)("span",{className:"text-sm text-neutral-700",children:["J'accepte les"," ",(0,a.jsx)("a",{href:"/conditions",target:"_blank",className:"text-primary-600 hover:underline",children:"conditions g\xe9n\xe9rales"})," ","et la"," ",(0,a.jsx)("a",{href:"/confidentialite",target:"_blank",className:"text-primary-600 hover:underline",children:"politique de confidentialit\xe9"})]})]}),(0,a.jsx)("button",{type:"submit",disabled:!i||m||n||!j,className:"btn-primary w-full justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:m||n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.A,{className:"h-5 w-5 animate-spin"}),"Traitement en cours..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.A,{className:"h-5 w-5"}),"Confirmer et payer ",s.toFixed(2),"$"]})})]})}var z=t(18224),G=t(94511);let L=null;var M=t(1274);function J(e){let{params:s}=e,f=(0,r.use)(s).chambreId,N=(0,n.useRouter)(),y=(0,n.useSearchParams)(),P=(0,g.j)(),{rooms:C,loading:I}=(0,g.G)(e=>e.rooms),[E,O]=(0,r.useState)(0),[F,$]=(0,r.useState)([]),[R,q]=(0,r.useState)(null),[W,J]=(0,r.useState)(null),[V,U]=(0,r.useState)(null),[B,H]=(0,r.useState)(!1),[X,Q]=(0,r.useState)(null),[Y]=(0,r.useState)(()=>(()=>{if(!L){let e="pk_test_51SLSZELi2PULQG33PoHpcOWCyFxg8fCH1psjJPMO9wr1IvbQwEJL9AvwuRpr49lnRWAUZmfiDuniNXvaCdpAGA8I00Cklnb2u6";e||console.warn("⚠️ NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY n'est pas d\xe9fini"),L=(0,G.c)(e)}return L})()),[Z,K]=(0,r.useState)(y.get("checkIn")||""),[ee,es]=(0,r.useState)(y.get("checkOut")||""),[et,ea]=(0,r.useState)(Number(y.get("guests"))||1);(0,r.useEffect)(()=>{0===C.length&&P((0,z.RM)())},[P,C.length]);let er=C.find(e=>e.id===f);if((0,r.useEffect)(()=>{er&&et>er.capacite&&ea(er.capacite)},[er,et]),(0,r.useEffect)(()=>{let e=F.reduce((e,s)=>e+(s.prixSelectionne||s.prix||0)*(s.nombrePersonnes||1),0),s=.9*e;F.length>0&&(console.log("\uD83E\uDDD6 Services spa s\xe9lectionn\xe9s:",F),console.log("\uD83D\uDCB0 Prix des services spa (avant r\xe9duction):",e.toFixed(2),"$"),console.log("\uD83D\uDCB0 Prix des services spa (apr\xe8s r\xe9duction):",s.toFixed(2),"$"))},[F]),I||!er)return(0,a.jsx)("div",{className:"min-h-screen pt-16 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-primary-600 border-r-transparent mb-4"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"Chargement de la r\xe9servation..."})]})});let el={id:f,nom:er.nom,type:er.type,categorie:er.categorie,prix:er.prix,prixWeekend:er.prixWeekend,image:er.images[0],capacite:er.capacite},en=()=>{if(!Z||!ee)return 0;let e=new Date(Z);return Math.ceil(Math.abs(new Date(ee).getTime()-e.getTime())/864e5)},ei=(null==X?void 0:X.numberOfNights)||en(),ec=(null==X?void 0:X.totalPrice)||(Z&&ee?S(A(Z),A(ee),el.prix,el.prixWeekend).totalPrice:ei*el.prix),eo=ec+.9*F.reduce((e,s)=>e+(s.prixSelectionne||s.prix||0)*(s.nombrePersonnes||1),0),ed=.05*eo,em=.09975*eo,ex=eo+ed+em,eu=[{number:0,title:"Dates",icon:o.A},{number:1,title:"Services",icon:d.A},{number:2,title:"Informations",icon:m.A},{number:3,title:"Paiement",icon:x.A}],ep=async()=>{if(E<3){var e,s,t,a,r,l,n,i,c,o,d,m,x,u,p,h,j,b,v;if(0===E&&Z&&ee){let i=new Date(Z),c=new Date(ee);if(c<=i)return void alert("La date de d\xe9part doit \xeatre au moins 1 jour apr\xe8s la date d'arriv\xe9e");try{let e=i.toISOString(),s=c.toISOString();console.log("\uD83D\uDCCA Calcul du prix avec:",{roomType:el.type,checkInDate:e,checkOutDate:s,numberOfGuests:et});let t=await (0,M.wN)({roomType:el.type,checkInDate:e,checkOutDate:s,numberOfGuests:et});console.log("✅ Prix calcul\xe9 par le backend:",t.data.data),console.log("\uD83D\uDCCA D\xe9tails du prix backend:",{totalPrice:t.data.data.totalPrice,numberOfNights:t.data.data.numberOfNights,pricePerNight:t.data.data.pricePerNight,taxes:t.data.data.taxes,includesTaxes:t.data.data.includesTaxes}),Q(t.data.data)}catch(c){console.error("❌ Erreur lors du calcul du prix:",c),console.error("\uD83D\uDCCB D\xe9tails complets de l'erreur:",null==(e=c.response)?void 0:e.data),console.error("\uD83D\uDD0D D\xe9tails de validation:",JSON.stringify(null==(t=c.response)||null==(s=t.data)?void 0:s.error,null,2));let i="Erreur lors du calcul du prix";if(null==(r=c.response)||null==(a=r.data)?void 0:a.error){let e=c.response.data.error;i="object"==typeof e?"Erreurs de validation:\n"+Object.entries(e).map(e=>{let[s,t]=e;return"- ".concat(s,": ").concat(t)}).join("\n"):e.toString()}else(null==(n=c.response)||null==(l=n.data)?void 0:l.message)&&(i=c.response.data.message);alert(i);return}}if(2===E&&R)try{let e=new Date(Z).toISOString(),s=new Date(ee).toISOString();F.reduce((e,s)=>{let t=s.prixSelectionne||s.prix||0,a=s.nombrePersonnes||1;return e+t*a},0);let t={roomType:el.type,checkInDate:e,checkOutDate:s,numberOfGuests:et,guest:{firstName:R.prenom,lastName:R.nom,email:R.email,phone:R.telephone,...R.adresse&&R.adresse.trim()&&{address:R.adresse}},...R.commentaires&&R.commentaires.trim()&&{specialRequests:R.commentaires},...F.length>0&&{spaServices:F.map(e=>{let s=e.prixSelectionne||e.prix,t=e.nombrePersonnes||1;return{spaServiceId:e.id,duree:e.dureeSelectionnee,prix:s*t*.9,nombrePersonnes:t,date:e.date||Z,heure:e.heure||"10:00",...e.notes&&{notes:e.notes}}})}};console.log("\uD83D\uDCDD Cr\xe9ation r\xe9servation PENDING avec:",t),console.log("\uD83D\uDCCB JSON stringifi\xe9:",JSON.stringify(t,null,2));let a=await (0,M.lz)(t);console.log("✅ R\xe9servation PENDING cr\xe9\xe9e - R\xc9PONSE COMPL\xc8TE:",JSON.stringify(a.data,null,2));let r=a.data.data,l=(null==(i=r.reservation)?void 0:i.id)||r.id,n=(null==(c=r.guest)?void 0:c.id)||r.guestId||(null==(o=r.reservation)?void 0:o.guestId)||(null==(m=r.reservation)||null==(d=m.guest)?void 0:d.id);if(!l)throw Error("ID de r\xe9servation non trouv\xe9 dans la r\xe9ponse");console.log("\uD83D\uDD11 Reservation ID extrait:",l),console.log("\uD83D\uDC64 Guest ID extrait:",n),console.log("\uD83D\uDCCA Structure responseData:",Object.keys(r)),r.reservation&&console.log("\uD83D\uDCCA Structure reservation:",Object.keys(r.reservation)),r.guest&&console.log("\uD83D\uDCCA Structure guest:",Object.keys(r.guest)),J(l),U(n||null),console.log("✅ R\xe9servation cr\xe9\xe9e avec services spa inclus (g\xe9r\xe9s par le backend)")}catch(s){console.error("❌ Erreur lors de la cr\xe9ation de la r\xe9servation:",s),console.error("\uD83D\uDCCB D\xe9tails de l'erreur:",null==(x=s.response)?void 0:x.data),console.error("\uD83D\uDD0D D\xe9tails de validation:",JSON.stringify(null==(p=s.response)||null==(u=p.data)?void 0:u.error,null,2));let e="Erreur lors de la cr\xe9ation de la r\xe9servation";if(null==(j=s.response)||null==(h=j.data)?void 0:h.error){let t=s.response.data.error;e="object"==typeof t?"Erreurs de validation:\n"+Object.entries(t).map(e=>{let[s,t]=e;return"- ".concat(s,": ").concat(t)}).join("\n"):t.toString()}else(null==(v=s.response)||null==(b=v.data)?void 0:b.message)&&(e=s.response.data.message);alert(e);return}O(E+1),window.scrollTo({top:0,behavior:"smooth"})}},eh=async e=>{var s,a,r;if(!W)return void alert("Erreur: ID de r\xe9servation manquant");H(!0);try{console.log("\uD83D\uDCB3 Confirmation du paiement pour r\xe9servation:",W),console.log("\uD83D\uDCB0 Montant total avec taxes:",ex);let a=await (0,M.Xe)(W,{paymentMethodId:e,amount:ex}),r=a.data.data;console.log("✅ Paiement confirm\xe9 - R\xc9PONSE COMPL\xc8TE:",JSON.stringify(a.data,null,2)),console.log("\uD83D\uDD0D Structure de la r\xe9servation confirm\xe9e:",Object.keys(r)),console.log("\uD83D\uDCCB reservationNumber:",r.reservationNumber),console.log("\uD83C\uDD94 confirmedReservation.id:",r.id),console.log("\uD83D\uDC64 confirmedReservation.guest:",r.guest),console.log("\uD83D\uDC64 confirmedReservation.guestId:",r.guestId);let l=r.reservationNumber||r.id||W,n=V||(null==(s=r.guest)?void 0:s.id)||r.guestId;console.log("✅ ID R\xe9servation extrait:",l),console.log("✅ ID Client extrait:",n),console.log("\uD83D\uDCCC guestIdState (\xe9tape 2):",V);let i={reservationNumber:l||"N/A",guestId:n||"N/A",date:new Date().toLocaleDateString("fr-CA"),chambre:{nom:el.nom,categorie:el.categorie,prix:el.prix},dateDebut:Z,dateFin:ee,nombreNuits:ei,nombrePersonnes:et,client:{nom:(null==R?void 0:R.nom)||"",prenom:(null==R?void 0:R.prenom)||"",email:(null==R?void 0:R.email)||"",telephone:(null==R?void 0:R.telephone)||""},services:F.map(e=>{let s=e.prixSelectionne||e.prix||0,t=e.nombrePersonnes||1,a=s*t;return{nom:e.nom,prix:.9*a,prixOriginal:a,duree:e.dureeSelectionnee,nombrePersonnes:t}}),subtotal:eo,tps:ed,tvq:em,total:ex};console.log("\uD83E\uDDFE Donn\xe9es du re\xe7u PDF:",i),console.log("\uD83D\uDCC4 G\xe9n\xe9ration du re\xe7u PDF...");try{let{generateReceiptPDF:e}=await t.e(390).then(t.bind(t,20390));await e(i),console.log("✅ Re\xe7u PDF g\xe9n\xe9r\xe9 avec succ\xe8s")}catch(e){console.error("❌ Erreur lors de la g\xe9n\xe9ration du PDF:",e)}console.log("\uD83D\uDCAC Affichage du message de succ\xe8s..."),alert("✅ Paiement confirm\xe9 avec succ\xe8s !\n\n\uD83D\uDCC4 Votre re\xe7u (N\xb0 ".concat(l,") a \xe9t\xe9 t\xe9l\xe9charg\xe9.\n\n\uD83C\uDFE0 Redirection vers l'accueil dans quelques instants...")),console.log("\uD83D\uDD04 Pr\xe9paration de la redirection..."),setTimeout(()=>{console.log("\uD83C\uDFE0 Redirection vers l'accueil"),N.push("/")},2e3)}catch(e){console.error("Erreur lors de la confirmation du paiement:",e),alert((null==(r=e.response)||null==(a=r.data)?void 0:a.message)||"Erreur lors du paiement")}finally{H(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen pt-16 bg-gradient-to-b from-neutral-50 to-white",children:[(0,a.jsx)("section",{className:"bg-white border-b border-neutral-200",children:(0,a.jsx)("div",{className:"container-custom py-4",children:(0,a.jsxs)("button",{onClick:()=>N.back(),className:"flex items-center gap-2 text-neutral-700 hover:text-primary-600 transition-colors",children:[(0,a.jsx)(u.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"font-medium",children:"Retour"})]})})}),(0,a.jsx)("section",{className:"bg-white border-b border-neutral-200 sticky top-16 z-40",children:(0,a.jsx)("div",{className:"container-custom py-6",children:(0,a.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,a.jsx)("div",{className:"flex items-center justify-center",children:eu.map((e,s)=>{let t=e.icon,r=E===e.number,l=E>e.number;return(0,a.jsxs)("div",{className:"flex items-center flex-1",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center flex-1",children:[(0,a.jsxs)("div",{className:"relative flex h-12 w-12 items-center justify-center rounded-full transition-all duration-300 ".concat(l?"bg-green-600 text-white":r?"bg-primary-600 text-white ring-2 ring-primary-200":"bg-neutral-100 text-neutral-400"),children:[l?(0,a.jsx)(p.A,{className:"h-5 w-5"}):(0,a.jsx)(t,{className:"h-5 w-5"}),(0,a.jsx)("div",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full text-xs font-bold ".concat(l||r?"bg-white text-primary-600":"bg-neutral-200 text-neutral-500"),children:e.number+1})]}),(0,a.jsx)("span",{className:"mt-2 text-xs font-medium transition-colors ".concat(r?"text-primary-700":l?"text-green-700":"text-neutral-500"),children:e.title})]}),s<eu.length-1&&(0,a.jsx)("div",{className:"hidden md:block relative flex-1 mx-2",style:{maxWidth:"80px"},children:(0,a.jsx)("div",{className:"h-0.5 bg-neutral-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full transition-all duration-500 ".concat(l?"bg-green-600 w-full":"w-0")})})})]},e.number)})})})})}),(0,a.jsx)("section",{className:"py-8 lg:py-12",children:(0,a.jsx)("div",{className:"container-custom",children:(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6 mb-6",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"relative w-24 h-24 rounded-xl overflow-hidden flex-shrink-0",children:(0,a.jsx)(i.default,{src:el.image,alt:el.nom,fill:!0,className:"object-cover"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("span",{className:"badge-gold mb-2",children:el.categorie}),(0,a.jsx)("h2",{className:"font-display text-xl font-bold text-neutral-900 mb-2",children:el.nom}),(0,a.jsx)("div",{className:"flex flex-wrap gap-4 text-sm text-neutral-600",children:Z&&ee?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[new Date(Z).toLocaleDateString("fr-CA")," -"," ",new Date(ee).toLocaleDateString("fr-CA")]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[et," personne",et>1?"s":""]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(h.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[ei," nuit",ei>1?"s":""]})]})]}):(0,a.jsxs)("div",{className:"flex items-center gap-1.5 text-amber-600",children:[(0,a.jsx)(j.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:"Veuillez s\xe9lectionner vos dates de s\xe9jour"})]})})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-display text-2xl font-bold text-primary-600",children:Z&&ee&&S(A(Z),A(ee),el.prix,el.prixWeekend).hasWeekend?"".concat(el.prixWeekend,"$"):"".concat(el.prix,"$")}),(0,a.jsx)("div",{className:"text-sm text-neutral-600",children:Z&&ee&&(S(A(Z),A(ee),el.prix,el.prixWeekend).hasWeekend?"prix week-end/nuit":"par nuit")||"par nuit"})]})]})}),(0,a.jsxs)(l.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},children:[0===E&&(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsx)("h2",{className:"font-display text-2xl font-bold text-neutral-900 mb-6",children:"S\xe9lectionnez vos dates de s\xe9jour"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-neutral-700 mb-2",children:"Date d'arriv\xe9e *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,a.jsx)("input",{type:"date",required:!0,value:Z,onChange:e=>K(e.target.value),min:new Date().toISOString().split("T")[0],className:"input-custom pl-11"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-neutral-700 mb-2",children:"Date de d\xe9part *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,a.jsx)("input",{type:"date",required:!0,value:ee,onChange:e=>es(e.target.value),min:Z?new Date(new Date(Z).getTime()+864e5).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],className:"input-custom pl-11"})]}),Z&&(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:"La date de d\xe9part doit \xeatre au moins 1 jour apr\xe8s la date d'arriv\xe9e"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-neutral-700 mb-2",children:"Nombre de personnes *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(m.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,a.jsx)("select",{value:et,onChange:e=>ea(Number(e.target.value)),className:"input-custom pl-11",children:Array.from({length:el.capacite},(e,s)=>s+1).map(e=>(0,a.jsxs)("option",{value:e,children:[e," ",e>1?"personnes":"personne"]},e))})]})]}),Z&&ee&&(0,a.jsx)("div",{className:"bg-primary-50 border border-primary-200 rounded-xl p-4",children:X?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(b.A,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm font-semibold text-green-700",children:"Disponibilit\xe9 confirm\xe9e"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700",children:"Dur\xe9e du s\xe9jour:"}),(0,a.jsxs)("span",{className:"font-bold text-primary-700",children:[X.numberOfNights," ",X.numberOfNights>1?"nuits":"nuit"]})]}),(()=>{let e=k(A(Z),A(ee));return e>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2 bg-amber-50 border border-amber-200 rounded-lg px-3 py-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 text-amber-600"}),(0,a.jsxs)("span",{className:"text-xs font-semibold text-amber-700",children:["Inclut ",e," nuit",e>1?"s":""," de weekend (tarif sp\xe9cial)"]})]})})(),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700",children:"Prix de la chambre:"}),(0,a.jsxs)("span",{className:"font-display text-2xl font-bold text-primary-600",children:[X.totalPrice,"$"]})]}),(0,a.jsx)("div",{className:"text-xs text-neutral-600 mt-2",children:"Prix calcul\xe9 par le syst\xe8me de r\xe9servation"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700",children:"Dur\xe9e du s\xe9jour:"}),(0,a.jsxs)("span",{className:"font-bold text-primary-700",children:[en()," ",en()>1?"nuits":"nuit"]})]}),(()=>{let e=k(A(Z),A(ee));return e>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2 bg-amber-50 border border-amber-200 rounded-lg px-3 py-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 text-amber-600"}),(0,a.jsxs)("span",{className:"text-xs font-semibold text-amber-700",children:["Inclut ",e," nuit",e>1?"s":""," de weekend"]})]})})(),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700",children:"Prix estim\xe9:"}),(0,a.jsxs)("span",{className:"font-display text-2xl font-bold text-primary-600",children:[(eo+ed+em).toFixed(2),"$"]})]}),(0,a.jsx)("div",{className:"text-xs text-neutral-600 mt-2",children:(()=>{let e=S(A(Z),A(ee),el.prix,el.prixWeekend);return e.hasWeekend?"".concat(e.weekdayNights," nuit").concat(e.weekdayNights>1?"s":""," \xd7 ").concat(el.prix,"$ + ").concat(e.weekendNights," nuit").concat(e.weekendNights>1?"s":""," weekend \xd7 ").concat(el.prixWeekend,"$"):"".concat(el.prix,"$ \xd7 ").concat(en()," ").concat(en()>1?"nuits":"nuit")})()})]})})]})]}),1===E&&(0,a.jsx)(w,{selectedServices:F,onServicesChange:$,checkIn:Z,checkOut:ee}),2===E&&(0,a.jsx)(T,{onClientInfoChange:q,initialData:R}),3===E&&(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsx)("h2",{className:"font-display text-2xl font-bold text-neutral-900 mb-6",children:"Paiement s\xe9curis\xe9"}),(0,a.jsx)(c.S8,{stripe:Y,children:(0,a.jsx)(_,{amount:ex,onSuccess:eh,onError:e=>{console.error("Erreur de paiement:",e)},loading:B})})]})]},E),3!==E&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-8",children:[(0,a.jsxs)("button",{onClick:()=>{E>0&&(O(E-1),window.scrollTo({top:0,behavior:"smooth"}))},disabled:0===E,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)(u.A,{className:"h-4 w-4"}),"Retour"]}),(0,a.jsxs)("button",{onClick:ep,disabled:0===E&&(!Z||!ee)||2===E&&(!R||!R.prenom||!R.nom||!R.email||!R.telephone),className:"btn-primary group disabled:opacity-50 disabled:cursor-not-allowed",children:["Continuer",(0,a.jsx)(v.A,{className:"h-4 w-4 group-hover:translate-x-1 transition-transform"})]})]})]}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsx)("div",{className:"sticky top-28",children:(0,a.jsx)(D,{chambre:el,nights:ei,selectedServices:F,total:ex,subtotal:0,tps:0,tvq:0,chambrePrix:ec})})})]})})})]})}},57629:(e,s,t)=>{Promise.resolve().then(t.bind(t,25772))}},e=>{e.O(0,[4486,887,5125,3400,1171,7540,8441,1255,7358],()=>e(e.s=57629)),_N_E=e.O()}]);